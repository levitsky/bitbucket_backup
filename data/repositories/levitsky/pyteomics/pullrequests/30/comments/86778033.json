{"links": {"self": {"href": "data/repositories/levitsky/pyteomics/pullrequests/30/comments/86778033.json"}, "html": {"href": "#!/levitsky/pyteomics/pull-requests/30/_/diff#comment-86778033"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 30, "links": {"self": {"href": "data/repositories/levitsky/pyteomics/pullrequests/30.json"}, "html": {"href": "#!/levitsky/pyteomics/pull-requests/30"}}, "title": "Feature: Implement XML parameter repackaging for detecting empty parameters"}, "content": {"raw": "Wow, I barely finished processing your email and you\u2019ve already written a PR!\n\nI\u2019ve checked how `_promote_empty_param_to_name` works, and yes, it helps in some cases. We can fix the duplication, though, can't we? We could do\n\n```python\nif len(empty_values) == 1 and 'name' not in info:\n    info['name'] = empty_values[0].name\n    del info[empty_values[0].name]\n```\n\nI tried this and what I got with the test mzid file is that those dicts got collapsed into the main dict nicely \\(apparently per line 463 in xml.py\\).\n\nAlso it's interesting that I don't get any failed tests from the `warnings` patching line.", "markup": "markdown", "html": "<p>Wow, I barely finished processing your email and you\u2019ve already written a PR!</p>\n<p>I\u2019ve checked how <code>_promote_empty_param_to_name</code> works, and yes, it helps in some cases. We can fix the duplication, though, can't we? We could do</p>\n<div class=\"codehilite language-python\"><pre><span></span><span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">empty_values</span><span class=\"p\">)</span> <span class=\"o\">==</span> <span class=\"mi\">1</span> <span class=\"ow\">and</span> <span class=\"s1\">&#39;name&#39;</span> <span class=\"ow\">not</span> <span class=\"ow\">in</span> <span class=\"n\">info</span><span class=\"p\">:</span>\n    <span class=\"n\">info</span><span class=\"p\">[</span><span class=\"s1\">&#39;name&#39;</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">empty_values</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">name</span>\n    <span class=\"k\">del</span> <span class=\"n\">info</span><span class=\"p\">[</span><span class=\"n\">empty_values</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"p\">]</span>\n</pre></div>\n\n\n<p>I tried this and what I got with the test mzid file is that those dicts got collapsed into the main dict nicely (apparently per line 463 in xml.py).</p>\n<p>Also it's interesting that I don't get any failed tests from the <code>warnings</code> patching line.</p>", "type": "rendered"}, "created_on": "2018-12-29T20:44:13.776051+00:00", "user": {"display_name": "Lev Levitsky", "uuid": "{eb44325f-4ee0-4e0b-a27c-f2ea23122a56}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Beb44325f-4ee0-4e0b-a27c-f2ea23122a56%7D"}, "html": {"href": "https://bitbucket.org/%7Beb44325f-4ee0-4e0b-a27c-f2ea23122a56%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/a2593c44c42429c503d2e5e9e307e241d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsLL-6.png"}}, "nickname": "levitsky", "type": "user", "account_id": "557058:986c547b-c50a-40b3-948a-29b4a93b7b30"}, "updated_on": "2018-12-29T20:44:37.474299+00:00", "type": "pullrequest_comment", "id": 86778033}