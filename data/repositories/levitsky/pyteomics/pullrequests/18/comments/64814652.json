{"links": {"self": {"href": "data/repositories/levitsky/pyteomics/pullrequests/18/comments/64814652.json"}, "html": {"href": "#!/levitsky/pyteomics/pull-requests/18/_/diff#comment-64814652"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 18, "links": {"self": {"href": "data/repositories/levitsky/pyteomics/pullrequests/18.json"}, "html": {"href": "#!/levitsky/pyteomics/pull-requests/18"}}, "title": "Re-add missing `_retrieve_refs` method to `XML`."}, "content": {"raw": "Adding `referenceableParamGroupRef` to `_structures_to_flatten` produces undesirable flattening:\n\n\n```python\n[{'componentList': {'analyzer': [{'fourier transform ion cyclotron resonance mass spectrometer': '',\n     'order': '2'}],\n   'count': 3,\n   'detector': [{'inductive detector': '', 'order': '3'}],\n   'source': [{'electrospray inlet': '',\n     'electrospray ionization': '',\n     'order': '1'}]},\n  'id': 'IC1',\n  'referenceableParamGroupRef': [{'LTQ FT': '', # NOTE\n    'instrument serial number': 'SN06061F'}],\n  'softwareRef': {'Xcalibur': '', 'version': '1.1 Beta 7'}},\n {'componentList': {'analyzer': [{'order': '2',\n     'radial ejection linear ion trap': ''}],\n   'count': 3,\n   'detector': [{'electron multiplier': '', 'order': '3'}],\n   'source': [{'electrospray inlet': '',\n     'electrospray ionization': '',\n     'order': '1'}]},\n  'id': 'IC2',\n  'referenceableParamGroupRef': [{'LTQ FT': '',\n    'instrument serial number': 'SN06061F'}],\n  'softwareRef': {'Xcalibur': '', 'version': '1.1 Beta 7'}}]\n```\nBecomes \n\n```python\n[{'LTQ FT': 'instrument serial number', # NOTE\n  'componentList': {'analyzer': [{'fourier transform ion cyclotron resonance mass spectrometer': '',\n     'order': '2'}],\n   'count': 3,\n   'detector': [{'inductive detector': '', 'order': '3'}],\n   'source': [{'electrospray inlet': '',\n     'electrospray ionization': '',\n     'order': '1'}]},\n  'id': 'IC1',\n  'softwareRef': {'Xcalibur': '', 'version': '1.1 Beta 7'}},\n {'LTQ FT': 'instrument serial number',\n  'componentList': {'analyzer': [{'order': '2',\n     'radial ejection linear ion trap': ''}],\n   'count': 3,\n   'detector': [{'electron multiplier': '', 'order': '3'}],\n   'source': [{'electrospray inlet': '',\n     'electrospray ionization': '',\n     'order': '1'}]},\n  'id': 'IC2',\n  'softwareRef': {'Xcalibur': '', 'version': '1.1 Beta 7'}}]\n```", "markup": "markdown", "html": "<p>Adding <code>referenceableParamGroupRef</code> to <code>_structures_to_flatten</code> produces undesirable flattening:</p>\n<div class=\"codehilite language-python\"><pre><span></span><span class=\"p\">[{</span><span class=\"s1\">&#39;componentList&#39;</span><span class=\"p\">:</span> <span class=\"p\">{</span><span class=\"s1\">&#39;analyzer&#39;</span><span class=\"p\">:</span> <span class=\"p\">[{</span><span class=\"s1\">&#39;fourier transform ion cyclotron resonance mass spectrometer&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;&#39;</span><span class=\"p\">,</span>\n     <span class=\"s1\">&#39;order&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;2&#39;</span><span class=\"p\">}],</span>\n   <span class=\"s1\">&#39;count&#39;</span><span class=\"p\">:</span> <span class=\"mi\">3</span><span class=\"p\">,</span>\n   <span class=\"s1\">&#39;detector&#39;</span><span class=\"p\">:</span> <span class=\"p\">[{</span><span class=\"s1\">&#39;inductive detector&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;order&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;3&#39;</span><span class=\"p\">}],</span>\n   <span class=\"s1\">&#39;source&#39;</span><span class=\"p\">:</span> <span class=\"p\">[{</span><span class=\"s1\">&#39;electrospray inlet&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;&#39;</span><span class=\"p\">,</span>\n     <span class=\"s1\">&#39;electrospray ionization&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;&#39;</span><span class=\"p\">,</span>\n     <span class=\"s1\">&#39;order&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;1&#39;</span><span class=\"p\">}]},</span>\n  <span class=\"s1\">&#39;id&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;IC1&#39;</span><span class=\"p\">,</span>\n  <span class=\"s1\">&#39;referenceableParamGroupRef&#39;</span><span class=\"p\">:</span> <span class=\"p\">[{</span><span class=\"s1\">&#39;LTQ FT&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;&#39;</span><span class=\"p\">,</span> <span class=\"c1\"># NOTE</span>\n    <span class=\"s1\">&#39;instrument serial number&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;SN06061F&#39;</span><span class=\"p\">}],</span>\n  <span class=\"s1\">&#39;softwareRef&#39;</span><span class=\"p\">:</span> <span class=\"p\">{</span><span class=\"s1\">&#39;Xcalibur&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;version&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;1.1 Beta 7&#39;</span><span class=\"p\">}},</span>\n <span class=\"p\">{</span><span class=\"s1\">&#39;componentList&#39;</span><span class=\"p\">:</span> <span class=\"p\">{</span><span class=\"s1\">&#39;analyzer&#39;</span><span class=\"p\">:</span> <span class=\"p\">[{</span><span class=\"s1\">&#39;order&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;2&#39;</span><span class=\"p\">,</span>\n     <span class=\"s1\">&#39;radial ejection linear ion trap&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;&#39;</span><span class=\"p\">}],</span>\n   <span class=\"s1\">&#39;count&#39;</span><span class=\"p\">:</span> <span class=\"mi\">3</span><span class=\"p\">,</span>\n   <span class=\"s1\">&#39;detector&#39;</span><span class=\"p\">:</span> <span class=\"p\">[{</span><span class=\"s1\">&#39;electron multiplier&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;order&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;3&#39;</span><span class=\"p\">}],</span>\n   <span class=\"s1\">&#39;source&#39;</span><span class=\"p\">:</span> <span class=\"p\">[{</span><span class=\"s1\">&#39;electrospray inlet&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;&#39;</span><span class=\"p\">,</span>\n     <span class=\"s1\">&#39;electrospray ionization&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;&#39;</span><span class=\"p\">,</span>\n     <span class=\"s1\">&#39;order&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;1&#39;</span><span class=\"p\">}]},</span>\n  <span class=\"s1\">&#39;id&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;IC2&#39;</span><span class=\"p\">,</span>\n  <span class=\"s1\">&#39;referenceableParamGroupRef&#39;</span><span class=\"p\">:</span> <span class=\"p\">[{</span><span class=\"s1\">&#39;LTQ FT&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;&#39;</span><span class=\"p\">,</span>\n    <span class=\"s1\">&#39;instrument serial number&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;SN06061F&#39;</span><span class=\"p\">}],</span>\n  <span class=\"s1\">&#39;softwareRef&#39;</span><span class=\"p\">:</span> <span class=\"p\">{</span><span class=\"s1\">&#39;Xcalibur&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;version&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;1.1 Beta 7&#39;</span><span class=\"p\">}}]</span>\n</pre></div>\n\n\n<p>Becomes </p>\n<div class=\"codehilite language-python\"><pre><span></span><span class=\"p\">[{</span><span class=\"s1\">&#39;LTQ FT&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;instrument serial number&#39;</span><span class=\"p\">,</span> <span class=\"c1\"># NOTE</span>\n  <span class=\"s1\">&#39;componentList&#39;</span><span class=\"p\">:</span> <span class=\"p\">{</span><span class=\"s1\">&#39;analyzer&#39;</span><span class=\"p\">:</span> <span class=\"p\">[{</span><span class=\"s1\">&#39;fourier transform ion cyclotron resonance mass spectrometer&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;&#39;</span><span class=\"p\">,</span>\n     <span class=\"s1\">&#39;order&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;2&#39;</span><span class=\"p\">}],</span>\n   <span class=\"s1\">&#39;count&#39;</span><span class=\"p\">:</span> <span class=\"mi\">3</span><span class=\"p\">,</span>\n   <span class=\"s1\">&#39;detector&#39;</span><span class=\"p\">:</span> <span class=\"p\">[{</span><span class=\"s1\">&#39;inductive detector&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;order&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;3&#39;</span><span class=\"p\">}],</span>\n   <span class=\"s1\">&#39;source&#39;</span><span class=\"p\">:</span> <span class=\"p\">[{</span><span class=\"s1\">&#39;electrospray inlet&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;&#39;</span><span class=\"p\">,</span>\n     <span class=\"s1\">&#39;electrospray ionization&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;&#39;</span><span class=\"p\">,</span>\n     <span class=\"s1\">&#39;order&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;1&#39;</span><span class=\"p\">}]},</span>\n  <span class=\"s1\">&#39;id&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;IC1&#39;</span><span class=\"p\">,</span>\n  <span class=\"s1\">&#39;softwareRef&#39;</span><span class=\"p\">:</span> <span class=\"p\">{</span><span class=\"s1\">&#39;Xcalibur&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;version&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;1.1 Beta 7&#39;</span><span class=\"p\">}},</span>\n <span class=\"p\">{</span><span class=\"s1\">&#39;LTQ FT&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;instrument serial number&#39;</span><span class=\"p\">,</span>\n  <span class=\"s1\">&#39;componentList&#39;</span><span class=\"p\">:</span> <span class=\"p\">{</span><span class=\"s1\">&#39;analyzer&#39;</span><span class=\"p\">:</span> <span class=\"p\">[{</span><span class=\"s1\">&#39;order&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;2&#39;</span><span class=\"p\">,</span>\n     <span class=\"s1\">&#39;radial ejection linear ion trap&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;&#39;</span><span class=\"p\">}],</span>\n   <span class=\"s1\">&#39;count&#39;</span><span class=\"p\">:</span> <span class=\"mi\">3</span><span class=\"p\">,</span>\n   <span class=\"s1\">&#39;detector&#39;</span><span class=\"p\">:</span> <span class=\"p\">[{</span><span class=\"s1\">&#39;electron multiplier&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;order&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;3&#39;</span><span class=\"p\">}],</span>\n   <span class=\"s1\">&#39;source&#39;</span><span class=\"p\">:</span> <span class=\"p\">[{</span><span class=\"s1\">&#39;electrospray inlet&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;&#39;</span><span class=\"p\">,</span>\n     <span class=\"s1\">&#39;electrospray ionization&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;&#39;</span><span class=\"p\">,</span>\n     <span class=\"s1\">&#39;order&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;1&#39;</span><span class=\"p\">}]},</span>\n  <span class=\"s1\">&#39;id&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;IC2&#39;</span><span class=\"p\">,</span>\n  <span class=\"s1\">&#39;softwareRef&#39;</span><span class=\"p\">:</span> <span class=\"p\">{</span><span class=\"s1\">&#39;Xcalibur&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;version&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;1.1 Beta 7&#39;</span><span class=\"p\">}}]</span>\n</pre></div>", "type": "rendered"}, "created_on": "2018-05-21T14:24:27.810632+00:00", "user": {"display_name": "Joshua Klein", "uuid": "{919f0add-304d-4b9a-8889-d2622a3dbc96}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B919f0add-304d-4b9a-8889-d2622a3dbc96%7D"}, "html": {"href": "https://bitbucket.org/%7B919f0add-304d-4b9a-8889-d2622a3dbc96%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/7d0e70bc74f783efa621a2bdd228ca22d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJK-3.png"}}, "nickname": "mobiusklein", "type": "user", "account_id": "557058:ff82222f-afe5-4135-a1b7-8de99a00f669"}, "updated_on": "2018-05-21T14:24:27.958656+00:00", "type": "pullrequest_comment", "id": 64814652}